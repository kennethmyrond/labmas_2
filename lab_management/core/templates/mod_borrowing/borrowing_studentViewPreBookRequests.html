{% extends 'temp_navbar.html' %}
{% load socialaccount %}
{% block title %}View Pre-Book Requests{% endblock %}

{% block content %}
  <div class="pagetitle">
    <h1>Borrowing</h1>
    <nav>
      <ol class="breadcrumb">
        <li class="breadcrumb-item active">View Pre-Book Requests</li>
      </ol>
    </nav>
  </div><!-- End Page Title -->

  <section class="section">
    <div class="row">
      <div class="col-lg-12">
        <div class="card">
          <div class="card-body">
            <!-- Table with stripped rows -->
            <table class="table datatable">
              <thead>
                <tr>
                  <th>RF Number</th>
                  <th data-type="date" data-format="YYYY/DD/MM">Date Requested</th>
                  <th data-type="date" data-format="YYYY/DD/MM">Date Needed</th>
                  <th>Type</th>
                  <th>Status</th>
                  <th>Action</th> 
                </tr>
              </thead>
              <tbody>
                {% for request in prebook_requests %}
                <tr>
                  <td>
                    <a href="{% url 'borrowing_studentDetailedPreBookRequests' request.borrow_id %}">
                      {{ request.borrow_id }}
                    </a>
                  </td>
                  <td>{{ request.request_date|date:"Y/m/d" }}</td>
                  <td>{{ request.borrow_date|date:"Y/m/d" }}</td>
                  <td>
                    {% if request.due_date %}
                      Long-Term
                    {% else %}
                      One-Day
                    {% endif %}
                  </td>
                  <td>
                    {% if request.status == 'P' %}
                      Pending
                    {% elif request.status == 'A' %}
                      Approved
                    {% elif request.status == 'D' %}
                      Declined
                    {% endif %}
                  </td>
                  <td>
                    {% if request.status == 'P' %}
                      <button class="btn btn-danger btn-sm custom-cancel-btn" onclick="cancelRequest('{{ request.borrow_id }}')">Cancel</button>
                    {% endif %}
                  </td> 
                </tr>
                {% endfor %}
              </tbody>
            </table>
            <!-- End Table with stripped rows -->
          </div>
        </div>
      </div>
    </div>
  </section>

<script>
  function cancelRequest(rfNumber) {
    // Add your cancellation logic here (e.g., make an AJAX request to cancel the booking)
    alert('Cancel request for RF Number: ' + rfNumber);
  }
</script>

<style>
  .custom-cancel-btn {
    padding: 0.2rem 0.5rem; 
    font-size: 0.75rem; 
  }
</style>

{% endblock %}
